# -*- coding: utf-8 -*-
"""
Created on Tue Jul 26 23:16:10 2022

@author: David

LeetCode - Medium 2131. Longest Palindrome by Concatenating Two Letter Words

Runtime: 1183 ms, faster than 99.57% of Python3 online submissions for Longest Palindrome by Concatenating Two Letter Words.
Memory Usage: 38.3 MB, less than 54.28% of Python3 online submissions for Longest Palindrome by Concatenating Two Letter Words.
"""

# accepted solution
from collections import Counter

def longestPalindrome(words):
    # creating a hashmap and memory variables
    C = Counter(words) 
    res = 0
    middle = False
    
    # going through each individual word
    # C will be updated to avoid second passage use e.g. "cl" "lc"
    for word in C:
        # if the word contains the same letters e.g. "gg"
        if word==word[::-1]:
            tmp = C[word]%2             # can it "be" unique
            res += (C[word]//2)*4       # properly adding
            C.update({word: -C[word]})  # updating C
            
            # a middle for the palindrome has been found
            if not middle and tmp: middle = True
            continue # avoid second passage with second if 
        
        # cases like "ab" "ba"
        if word[::-1] in C:
            tmp = min(C[word],C[word[::-1]])
            res += tmp*4
            C.update({word:-tmp, word[::-1]:-tmp})
    
    # palindrome's middle exists "aa", add +2 to count
    if middle: res+= 2
        
    return res


# first thought - not accepted
# Time Limit Exceeded on LeetCode, works off-line
words = ["zi","iz","iz","zl","iz","ii","zz","ll","ll","zz","li","zz","li","lz","ii","lz","li","zl","ll","iz","zl","ll","iz","zi","zz","ll","li","ll","lz","lz","ll","li","li","zz","li","zz","zl","il","zl","li","lz","zl","zl","zi","lz","li","zi","lz","zl","lz","li","lz","lz","ll","zi","zl","zi","zz","li","il","zi","li","iz","zl","lz","il","ll","il","zz","zl","zi","zz","iz","il","ii","ll","lz","ll","li","zi","zz","il","zi","il","iz","zl","lz","iz","ll","zz","zi","ii","zl","ll","ll","ll","ii","ii","lz","zi","zz","lz","lz","zz","li","ii","iz","ll","ll","ll","zl","zl","iz","ll","ll","lz","il","il","zz","ll","il","li","zz","zi","zi","il","zz","zz","iz","il","ll","lz","lz","ii","zi","zi","zi","zz","li","li","zz","zz","zi","zl","iz","zl","lz","zl","li","lz","zz","lz","zi","zi","zz","lz","zi","zl","zl","zl","iz","zz","li","lz","il","li","il","zz","ll","lz","li","zz","ii","zl","ll","zi","ii","il","ll","zz","iz","li","lz","zi","zi","zl","zz","ll","il","ii","zi","zl","ii","il","zl","ll","zl","ii","ii","zi","zi","ll","zz","il","lz","zl","lz","ii","ll","zi","zz","zz","ii","zz","li","ii","zz","li","li","zz","zl","zi","il","zi","zi","iz","zi","ll","zl","ll","zl","il","iz","li","iz","li","li","zi","zi","zi","iz","ll","zi","zl","zi","li","ll","zl","zz","zi","il","iz","zz","iz","iz","iz","zl","zi","iz","iz","ii","il","zi","ii","zz","li","zi","iz","zl","ii","li","il","ll","ll","ll","li","ll","lz","li","lz","ll","iz","zz","il","iz","lz","zl","iz","ll","ii","lz","ll","lz","zz","lz","il","ll","li","lz","ii","lz","li","lz","li","ii","iz","lz","li","li","zl","iz","il","li","ii","lz","il","ll","li","iz","lz","lz","iz","li","zi","zi","zi","ii","zi","il","iz","zi","li","zl","li","ii","zi","iz","zz","zz","lz","zz","iz","zl","lz","il","zi","zz","zl","zl","zi","zz","ll","zi","zi","ll","lz","ll","il","zi","li","ll","ll","il","iz","li","ii","il","iz","ii","zi","zl","ll","lz","lz","zl","iz","zi","il","iz","ll","ii","il","zz","zl","li","zl","zl","li","iz","ll","zi","il","zi","iz","ii","ii","li","zi","li","zi","iz","zl","ii","iz","iz","li","zl","ll","il","zz","iz","zl","ii","li","il","ll","ll","iz","li","ll","zl","zi","lz","zi","ii","iz","zz","lz","iz","zz","zz","iz","li","zi","ll","zz","ii","zz","li","zl","lz","il","ii","ll","il","lz","ll","ii","zz","iz","zl","li","il","zl","zl","zl","iz","iz","zi","zi","zl","il","li","lz","iz","ii","iz","zz","li","lz","ll","li","lz","ll","lz","zi","lz","ii","lz","li","li","zl","zi","ii","ll","ll","zl","lz","li","li","li","zi","zl","li","il","zl","li","lz","iz","zi","ii","li","li","lz","zi","ll","zl","il","zi","lz","zl","ll","ii","li","zl","zi","il","li","zz","ii","zl","lz","il","il","zl","zi","zi","ii","zi","ll","iz","lz","zi","lz","ll","li","zz","il","il","zl","zi","zi","lz","lz","iz","ll","zi","ll","li","zi","zl","ii","zl","zi","zi","zz","iz","li","li","iz","lz","ll","li","zi","li","iz","li","ii","ii","iz","ii","iz","ii","li","iz","zi","ll","zz","zz","ii","zz","zi","il","il","zi","ii","lz","zi","il","iz","ii","iz","ll","il","zi","li","ll","zi","zi","zl","ii","zl","iz","il","zl","il","zz","zi","lz","zz","ll","lz","ll","li","iz","zl","ll","li","zz","zz","iz","zl","li","il","zi","il","zi","iz","iz","zl","iz","zl","zi","il","zl","ii","li","ll","lz","iz","ll","il","li","ii","iz","ll","iz","il","il","zl","zl","lz","ii","iz","ll","li","lz","zz","iz","ii","iz","il","zl","li","zz","lz","zl","lz","zl","zz","ll","ll","li","ll","zi","zl","zi","iz","zl","iz","zi","zl","li","zl","ii","ii","ll","lz","ii","zi","il","li","li","lz","il","zl","iz","lz","ii","iz","zi","lz","ii","zz","ll","ii","zl","ll","ii","il","iz","iz","lz","zi","iz","zl","ll","ii","ii","iz","il","lz","li","iz","lz","zi","lz","zz","li","ll","il","li","il","zi","lz","ll","zl","iz","zi","ll","lz","lz","zz","il","iz","zi","lz","iz","zl","il","il","zi","iz","ll","lz","ll","zz","zl","zl","zi","il","lz","ii","ii","zi","zi","zz","lz","iz","il","li","ii","ii","zl","zz","li","iz","lz","zl","lz","ii","il","zz","zl","ii","zi","iz","li","iz","zl","ii","ii","ll","lz","iz","ll","lz","ll","il","ii","lz","zl","zl","li","zl","iz","ll","ii","iz","li","ii","ll","zi","ll","iz","lz","zi","li","li","li","li","iz","zi","lz","zz","zi","ll","iz","lz","il","zl","lz","ii","li","ll","zl","ll","il","ll","iz","li","il","iz","li","ll","ii","lz","zi","ll","lz","ll","zi","zl","li","iz","zz","ll","lz","iz","zl","il","il","li","lz","ll","li","zz","zl","il","il","ll","ll","zi","ii","ii","li","li","ii","zl","li","li","zl","lz","iz","zi","zl","il","lz","zi","zl","ll","ll","il","zi","zl","ii","li","zi","li","zl","lz","li","iz","zl","iz","lz","ll","ii","ll","ll","zl","iz","zi","lz","li","ll","iz","il","zz","lz","li","zl","zz","zi","ll","iz","ll","zz","zl","zl","iz","lz","il","zz","zl","zi","il","zi","zi","ii","zz","zi","il","iz","ii","li","ll","ll","iz","iz","lz","ll","il","zi","ll","zi","il","li","ii","li","lz","ll","zz","il","zz","zl","il","ll","il","ii","zl","il","zl","il","zi","li","li","zz","zi","li","zz","il","zl","zl","li","lz","ii","ll","zi","lz","lz","zi","li","lz","lz","zi","lz","iz","zl","il","li","li","ll","li","zl","li","li","ii","zz","ll","li","iz","il","lz","ll","ii","ll","lz","zz","lz","zi","zl","ii","iz","zz","zi","il","lz","ii","iz","zl","zi","zz","zl","ll","zl","li","li","ii","lz","zz","zl","zl","zi","iz","ii","zi","il","il","zl","zl","ll","iz","zz","ll","iz","zl","iz","iz","zl","ii","zi","iz","ll","zl","ii","zl","li","zi","ll","li","li","zz","il","ii","iz","li","il","li","ll","il","li","lz","ll","li","zl","ll","zl","lz","il","il","li","zi","zz","il","zi","ii","ll","il","zz","zz","ll","ll","li","iz","lz","zl","lz","lz","zi","ll","li","lz","zl","il","ll","ll","zz","ii","lz","li","il","lz","lz","ll","iz","li","ll","zl","il","il","zz","zl","iz","iz","li","lz","zz","lz","ii","lz","iz","zl","zl","ll","zi","zi","zz","iz","ll","zl","li","ll","zi","lz","zi","ii","ll","il","zl","il","ll","ll","zz","ii","il","ii","il","iz","zi","zi","lz","iz","zz","ll","il","li","iz","zi","ii","ll","zi","ii","iz","li","li","li","iz","ll","iz","il","lz","lz","iz","zz","lz","lz","ll","zi","li","ii","iz","zl","zi","iz","il","lz","zl","zl","ii","zz","ii","ll","ll","ii","li","lz","il","il","zl","lz","zl","iz","ii","li","zz","il","zl","ii","ll","zi","iz","il","zz","zz","li","ll","iz","il","ii","zl","zl","il","li","ll","zz","zl","il","ii","ll","ii","iz","ll","iz","ll","ii","ll","il","iz","iz","zz","iz","zl","zl","ll","li","iz","ii","zi","il","ll","li","zl","li","ii","zl","li","il","zl","il","ii","lz","ii","zl","il","ii","il","zi","zl","zl","ii","lz","ii","ii","zz","iz","ii","zl","iz","zi","zz","ll","zi","lz","ll","li","ll","zz","il","zz","il","zz","zi","lz","ll","ii","lz","iz","zl","ii","zi","iz","li","lz","li","ii","zz","zl","ii","ii","il","zi","ll","iz","lz","lz","iz","zi","zi","ll","zz","zz","iz","lz","iz","zi","zz","ii","lz","li","zl","iz","zz","il","zz","zz","zz","iz","zz","ll","zi","ll","li","ii","li","zl","li","il","zz","iz","ii","zi","ll","ll","zz","zl","il","ll","ii","iz","zz","zi","zl","zz","zi","ii","li","ii","li","zi","iz","ii","li","li","ii","li","zl","lz","il","zz","ii","zi","zi","li","zz","lz","il","il","zz","lz","zi","ll","ii","zz","zi","ll","zl","zz","li","zz","ii","zz","lz","zi","ii","iz","zi","lz","li","iz","li","zi","zl","il","zl","il","iz","zz","zl","zl","ll","iz","ii","zi","li","ii","ii","il","ii","zi","zi","li","zl","zz","lz","ll","il","zl","ll","zz","zl","ii","lz","zi","ll","iz","lz","ii","lz","iz","zz","zz","zl","il","lz","ll","zl","zl","li","il","il","zz","zi","lz","li","il","lz","lz","zl","lz","zl","iz","li","zl","li","iz","zi","lz","zz","li","zi","il","iz","ll","ll","zz","li","il","li","lz","lz","ii","iz","lz","zz","lz","lz","il","li","iz","zi","iz","zi","iz","iz","zi","zi","li","li","il","lz","zi","li","li","il","zl","lz","lz","ll","il","lz","zi","ii","il","iz","ll","zi","zl","zi","zz","zl","zi","ii","il","ii","il","zi","zl","ii","zl","iz","il","zz","lz","li","lz","li","ii","ii","zz","lz","iz","il","ii","zl","lz","li","iz","zz","lz","zz","zz","iz","zi","iz","li","ii","zi","zl","ii","iz","lz","zi","zl","iz","iz","iz","ll","li","li","ii","li","ii","li","ll","li","iz","li","zl","zl","zl","iz","zz","ii","zz","iz","li","zz","zi","li","zl","ii","ll","ll","il","ll","iz","zz","zz","ii","li","ll","iz","il","ll","zz","iz","lz","il","li","zi","zi","ii","ii","zz","ll","il","li","zl","zi","zz","zz","zi","zi","il","zi","il","il","ll","zi","il","ii","zi","lz","zl","li","iz","zl","zl","zi","zi","lz","zl","li","ii","il","il","ll","li","ll","il","lz","ii","ii","zz","iz","zl","zz","zl","ii","il","ii","zl","ii","iz","iz","iz","lz","li","ll","zi","li","ii","zl","lz","zi","zl","zz","zz","lz","zi","il","zz","ii","zl","iz","zi","lz","ii","ll","ll","iz","zi","zi","li","il","ii","zz","lz","ii","lz","lz","li","lz","zl","li","zl","iz","lz","zi","li","zi","zz","il","li","lz","il","ii","ii","lz","ll","il","zi","ii","zi","zi","lz","lz","ii","ll","ii","zi","zl","ll","il","zi","lz","li","li","ll","li","lz","lz","li","zl","zl","ll","iz","ii","zi","ii","zl","li","lz","iz","ll","zi","ii","il","zi","ii","zi","il","zz","zz","iz","iz","lz","iz","ii","zl","ii","zi","iz","zz","zz","lz","zi","zz","ll","zl","lz","ll","il","il","iz","ii","zl","lz","lz","iz","zl","ll","ll","lz","zz","zi","ii","ll","zl","zz","ii","zi","zl","zi","zl","iz","ii","lz","il","ii","zz","iz","zi","il","zi","il","zz","zi","zi","ii","iz","zi","zl","zz","iz","zi","li","iz","lz","zz","li","zz","li","il","zi","iz","iz","il","il","ii","zl","zz","il","ii","il","lz","zz","lz","ll","ll","li","li","iz","li","iz","li","zl","ii","il","ll","ii","il","il","ll","il","lz","ii","iz","zz","lz","ii","il","iz","zl","lz","iz","il","ii","zz","lz","ll","ll","zl","iz","il","ll","ii","lz","ii","ll","zl","zz","lz","li","zl","il","zl","lz","ii","li","iz","lz","ii","il","ii","lz","iz","zl","iz","lz","zi","ll","ll","il","ii","li","il","lz","zz","lz","ll","ii","iz","iz","ll","lz","ii","ii","li","ll","li","ii","li","il","iz","zz","lz","lz","ii","lz","zi","ii","li","ll","zl","zl","zz","zz","li","iz","iz","ii","il","zi","ii","iz","zi","li","iz","il","il","ll","il","il","ii","ll","ii","ll","zz","iz","ii","zi","ll","zz","iz","li","lz","ii","zi","li","zz","ii","lz","ll","ii","ii","ll","ll","zl","il","zi","lz","zl","ii","zl","lz","li","zl","li","ll","li","li","il","li","li","zz","il","zz","zz","lz","zi","iz","zz","zi","lz","li","zl","zl","zl","lz","zi","ll","zi","lz","ii","zz","iz","zi","ll","lz","lz","ll","li","il","zi","lz","li","li","il","ll","lz","il","iz","li","li","zi","ll","zl","iz","zl","lz","li","ll","il","zz","zi","zi","ll","il","il","zl","zi","li","ii","iz","il","iz","ll","li","zl","zz","li","zi","lz","il","ii","zi","il","ii","ii","il","il","ll","il","zi","li","li","iz","zz","ii","zi","ii","li","zz","li","zi","zi","ii","li","lz","zz","li","zi","ii","il","li","li","li","li","iz","ll","li","zz","li","zz","li","lz","ll","ii","ii","ll","zz","zl","li","il","zl","li","li","zl","zl","ll","iz","ll","il","iz","zl","zi","li","li","zl","zi","ll","il","zz","zi","ll","ll","il","ll","il","li","il","ll","il","ll","li","zi","li","zl","zi","zl","il","iz","li","ii","zz","zi","zl","zz","zz","zi","ll","zl","zz","zi","lz","ll","zl","iz","zz","lz","il","li","li","li","ll","li","zi","zz","lz","ii","zz","iz","ii","ii","li","iz","iz","zi","zl","ii","zl","zi","lz","zl","il","zl","zl","ll","ii","zz","li","lz","ii","zl","iz","il","il","li","zi","ii","li","li","zi","il","zl","lz","zz","li","il","lz","il","iz","li","il","zl","il","li","lz","li","il","lz","ll","lz","zl","ll","zl","lz","zi","zl","zi","il","iz","ll","li","ii","li","li","iz","zz","lz","ii","ii","il","ii","il","lz","il","li","ll","lz","lz","li","ll","lz","zz","zl","zl","zl","zz","zz","li","lz","il","li","iz","iz","ii","zz","zz","iz","zi","iz","ll","il","zi","zi","li","iz","zl","zl","iz","ll","lz","ii","iz","zl","zi","lz","zl","zz","il","ii","li","zz","ii","zi","il","iz","zl","lz","li","ll","ll","ii","ll","iz","il","zl","zi","ll","ll","lz","il","lz","iz","ll","zl","ll","li","il","iz","li","lz","zz","zz","li","zi","zl","ll","zi","il","ll","zz","il","lz","iz","lz","zi","ll","ii","zz","il","iz","ll","lz","ll","iz","il","zi","zi","iz","ll","il","ll","zz","ii","zz","lz","zi","zz","lz","ii","zl","li","zl","iz","li","iz","lz","ii","iz","lz","ll","il","ii","ii","zl","zl","ll","ll","li","zl","li","ii","iz","il","li","li","iz","zi","ll","ii","il","lz","lz","zl","zi","zi","zz","ii","zz","li","il","zl","zl","ii","ll","il","iz","iz","lz","ii","li","zl","ii","lz","ll","iz","lz","li","lz","lz","ii","zz","il","zi","zi","zz","lz","li","zi","lz","ll","zl","zz","il","lz","lz","il","iz","ll","lz","il","iz","il","lz","zl","iz","li","ll","li","il","zz","zi","zi","lz","zz","il","ll","ii","zl","iz","zz","li","zz","ll","zl","zi","il","lz","zl","ll","ll","iz","zl","ll","zi","ll","zi","li","ii","li","ll","iz","zz","ii","zi","ll","lz","li","iz","il","li","zz","lz","zl","zz","ii","zl","ii","zl","ll","li","zi","ii","ll","zi","lz","lz","ii","li","li","li","zi","ll","ll","ll","il","li","zz","li","ii","lz","lz","lz","ii","ii","ii","lz","ii","lz","zz","ii","ll","lz","li","iz","zz","ll","lz","zl","iz","li","zi","il","lz","iz","zi","zi","zl","ii","lz","lz","lz","zl","zl","il","ll","zi","iz","lz","li","iz","ii","iz","il","ll","li","ii","lz","il","ll","zi","li","li","zi","il","lz","ii","ll","lz","ii","zi","zl","ll","lz","zz","lz","zi","il","zz","zl","ll","ii","il","lz","lz","ii","zz","zz","ll","ll","ii","zz","iz","zl","lz","il","ii","zl","il","ll","lz","zz","iz","li","li","zz","zl","zi","li","zz","iz","zi","lz","ll","iz","li","li","zi","iz","zi","iz","ll","lz","iz","zl","iz","lz","li","zz","zz","ii","ll","ll","lz","li","li","ll","zz","zl","ii","zi","iz","zz","li","ii","zi","ii","ii","ll","zi","ii","ii","zz","zi","zl","ll","ll","il","zi","ll","li","zl","li","iz","ii","zi","li","lz","lz","il","iz","li","lz","li","zi","zl","li","ii","zi","il","li","zl","ii","ii","zz","il","zi","iz","iz","zz","il","iz","zl","il","ii","zi","il","ii","li","lz","il","lz","ii","lz","zi","lz","ii","lz","il","zz","zi","zl","lz","zi","lz","ll","lz","zz","ii","li","ii","zl","li","zz","lz","ll","ii","iz","li","zi","iz","il","zz","ii","zl","iz","zi","zz","zl","zi","ii","ii","zl","iz","zl","lz","zi","zi","ii","il","iz","zz","zi","ll","zi","zz","zi","zz","ll","ii","zz","il","ii","li","ll","lz","il","zl","il","il","lz","zl","zl","zz","li","ll","ii","iz","ll","iz","ll","zz","zi","li","ii","li","zz","zz","iz","lz","ll","ii","zi","ll","zz","zi","iz","lz","ll","zi","iz","il","zl","zl","iz","ii","li","zi","zz","iz","zz","iz","lz","iz","zz","zz","ii","il","lz","iz","ll","zi","iz","lz","zl","zl","ll","li","zi","zi","iz","ll","li","ii","il","li","lz","zi","li","zl","zl","ii","li","ii","zl","ii","zi","lz","lz","il","iz","iz","iz","zi","il","ll","iz","iz","iz","il","zl","lz","zz","zz","iz","li","li","zz","zl","ll","il","zi","ii","zz","li","ll","il","ll","zz","il","zl","zi","ll","ll","zl","li","ll","zl","il","zl","zi","iz","ii","lz","ii","lz","il","il","lz","li","iz","il","iz","lz","ll","li","ii","iz","il","zi","ii","il","zz","zl","iz","ll","li","ll","zi","iz","lz","ii","li","ll","zl","zl","zl","li","ll","iz","zi","zi","lz","li","zi","ii","zi","zz","il","ii","zz","ll","iz","li","iz","zl","il","li","ii","ll","li","ll","il","ll","li","ii","zi","zi","zi","ii","ll","iz","ii","zz","ll","zl","lz","zi","il","il","lz","zl","li","li","ii","lz","zi","iz","li","li","lz","iz","ll","ll","il","ii","lz","li","zi","lz","lz","ll","zz","zi","ll","zi","zi","li","zl","ll","ii","il","zz","li","li","li","ll","li","ii","li","iz","iz","li","il","lz","iz","zl","lz","il","zl","iz","zl","il","iz","li","zl","zi","lz","li","ll","zi","zi","ll","iz","iz","li","li","iz","il","zz","zl","ii","ii","li","ii","zl","zz","ll","iz","lz","iz","ii","il","ii","ii","lz","ll","zl","zz","li","iz","zz","il","li","il","lz","lz","ll","iz","zl","zi","ll","zz","zi","zi","zz","zi","zi","zz","zi","il","zz","zl","zi","li","zi","lz","li","zi","ii","zl","zi","li","iz","zl","li","zz","zz","zi","iz","lz","iz","il","zz","zz","ii","zi","il","il","ll","il","li","ii","il","zz","lz","li","zi","ii","ii","ii","zz","zl","lz","ii","zl","iz","ll","zi","ii","li","lz","ii","zl","li","zz","ll","ll","zz","il","iz","ll","iz","zz","lz","li","ll","zi","iz","zz","iz","zl","zz","zl","zi","iz","zz","iz","ii","ii","zi","zl","iz","ii","ll","zi","ii","li","ll","ll","lz","zl","iz","iz","ii","zl","li","il","ii","zi","ll","zi","il","iz","zi","ii","ii","li","il","zz","lz","iz","iz","zz","iz","iz","ii","ll","li","il","zi","zl","li","zi","zl","zz","zi","li","zz","ll","zl","zz","li","lz","li","li","zi","lz","lz","iz","zz","zi","zz","zi","lz","zz","iz","il","iz","li","iz","li","il","zl","zi","iz","il","zl","li","zz","li","lz","ll","iz","li","il","ll","zi","lz","zz","il","zl","ll","zz","li","ll","iz","iz","ll","ii","il","zi","zi","iz","iz","il","zz","zl","zz","li","lz","lz","ll","li","zl","li","zi","ii","ll","zl","zi","iz","lz","ll","ll","il","ii","iz","ll","ii","iz","zl","zz","zz","zl","lz","zl","lz","zi","lz","ll","ll","zi","lz","lz","zz","zl","ii","ll","zz","zz","li","zl","lz","ll","li","lz","zi","li","lz","ii","lz","ll","li","zl","ii","lz","ll","zz","ll","il","li","zl","ii","zl","iz","zz","zi","zl","ii","zl","zi","li","zi","ll","iz","ll","iz","ii","zl","li","zz","ll","zz","il","li","iz","ll","li","iz","zi","zz","zi","ii","zl","ll","li","il","ll","iz","ii","ii","zl","zl","li","ll","zz","li","zi","ll","ll","ii","zz","ll","iz","il","ll","ll","li","li","zl","zi","li","zi","zi","zz","lz","ll","zl","iz","ii","ll","iz","li","ii","ll","ii","lz","zi","iz","zz","zl","lz","ll","ll","zl","iz","zz","zi","li","li","lz","il","zi","zl","zl","il","ii","lz","ll","zz","ii","il","zi","lz","ll","lz","ll","il","iz","zz","zz","ii","ll","iz","ii","ii","li","lz","li","ll","li","iz","zi","zi","lz","il","ii","il","zz","lz","iz","iz","il","iz","ii","ii","lz","iz","il","li","ii","lz","ii","zi","li","il","ii","iz","zi","zi","ii","iz","zi","ll","iz","lz","il","li","zz","zi","ll","iz","iz","ll","il","ll","iz","zl","ll","zl","zi","zz","ii","il","zi","iz","ii","iz","zz","li","zz","ii","ii","ll","zz","ll","il","zz","ll","zi","lz","iz","zz","il","ii","lz","il","lz","ll","zz","ll","zl","lz","zi","zi","il","li","zz","ll","ll","ii","il","ll","zi","zi","lz","il","ll","zl","li","il","zz","iz","iz","iz","ll","zl","ii","il","lz","ii","li","li","ll","lz","zz","ll","ll","zl","zl","ll","il","zz","zl","iz","iz","li","iz","zz","il","zz","zi","ii","lz","ll","zl","il","zl","li","ii","zz","zz","zi","zi","ll","zl","lz","zi","ll","zz","il","ii","ii","li","ii","zz","zi","zi","zi","iz","lz","li","il","iz","il","lz","iz","zi","ll","zz","ii","iz","li","il","zl","ll","zz","zi","zi","li","iz","lz","ll","iz","lz","ii","lz","ii","iz","iz","lz","zz","zi","li","ll","lz","zz","iz","zl","ll","ll","zi","lz","lz","zl","zz","zi","li","li","zi","iz","zz","ii","zi","zz","zi","zz","zi","ii","li","iz","il","li","zi","zz","lz","ll","li","il","ll","lz","zz","ii","ll","ll","il","zi","il","lz","il","li","zz","zl","zz","zi","ll","zz","ii","li","lz","iz","zz","zl","iz","zl","zz","ii","zi","lz","zi","zl","lz","iz","lz","zz","zz","zz","il","zl","zi","ll","ii","ll","ll","zi","iz","zi","zi","iz","zl","zz","lz","zl","li","li","lz","ii","ll","ll","zz","zl","li","lz","zz","li","il","il","iz","li","lz","iz","zi","zi","zz","ll","iz","lz","il","ii","lz","ii","ii","il","zi","iz","lz","ii","zz","iz","il","ii","lz","zl","il","zl","zl","li","zl","zz","il","zz","ll","ii","il","zi","il","iz","zl","zl","ii","ll","li","ll","zi","lz","lz","iz","zz","ii","il","zi","ii","zi","ll","ll","zi","li","zz","ll","li","zl","ii","il","ll","il","zl","zl","ll","zl","zi","iz","zl","lz","ii","zz","zz","lz","ll","li","ii","iz","iz","ii","zl","ii","ll","zi","zl","zi","ii","zl","ii","ll","ii","zi","il","zi","zi","zz","zz","ll","ll","zi","lz","il","il","zl","zi","zi","lz","zl","zi","iz","iz","ii","ll","li","li","il","ll","zl","zi","ll","ll","lz","ii","lz","zl","il","lz","li","ii","ii","zi","zz","zi","ll","zz","ii","zi","zz","lz","zz","zi","ii","li","zi","ii","zi","ll","ii","lz","li","zi","zz","iz","il","zi","lz","il","ll","iz","iz","zi","li","ii","il","ii","zi","ii","il","zz","ll","zl","zz","ll","zl","zz","iz","ii","zi","zl","zi","zl","zz","li","zi","li","zi","zz","zz","li","zz","zi","lz","zl","lz","zz","lz","il","li","il","ii","iz","zz","zz","il","ii","li","zl","zz","zi","zi","ii","zl","zl","il","zl","ll","li","iz","zz","zl","lz","zl","ii","ll","ll","zz","il","zi","iz","zz","il","il","zi","zl","iz","ll","lz","ll","zi","il","li","lz","li","lz","il","lz","zl","ll","zz","il","zi","zl","zz","iz","iz","zi","il","il","iz","li","ii","zz","ii","iz","zz","li","lz","li","iz","lz","zz","lz","zi","li","ii","zl","lz","zl","li","lz","zl","zi","ii","zi","zi","zz","zi","iz","li","zz","li","il","zz","li","il","zz","il","zz","ii","lz","zi","iz","zl","iz","il","zz","il","iz","zl","zi","ll","ii","zz","li","ll","lz","il","iz","ll","zi","zi","lz","li","ii","ii","zl","zi","zl","li","ll","ll","ll","il","li","il","zz","il","zi","iz","iz","li","zl","lz","zz","ll","il","zz","ii","iz","li","ll","il","iz","lz","ll","lz","zl","iz","li","il","ll","ll","lz","ii","il","ll","lz","lz","zz","zz","zl","li","li","zi","zi","ll","zl","zz","zz","ii","iz","zz","zl","iz","iz","ll","zl","zz","ll","zl","lz","lz","zl","lz","zi","zi","il","il","zl","ll","li","ll","ll","zl","zz","zi","zi","li","ll","zl","zi","li","zz","zl","zi","zz","ii","zz","zi","iz","zz","ii","zz","il","ll","iz","ll","il","iz","iz","iz","zi","zi","il","iz","zl","zi","ll","zl","zi","zi","li","zi","lz","li","iz","ll","zz","iz","il","zi","zz","zz","lz","zi","ll","zi","zi","il","zz","li","lz","iz","ll","ll","ll","zi","zl","li","lz","il","zi","ii","zz","iz","zz","zl","il","li","il","ll","ii","ll","zi","zl","ll","zi","zz","ii","li","ll","ll","lz","iz","lz","iz","li","il","lz"]

# returns True when a and b are palindrome
def isPalindromeByTwo(a,b):
    return a[0]==b[1] and a[1]==b[0]

# True if a contains 2 same letters
def sameLetters(a):
    return a[0]==a[1]

# True if tuple (word,index) hasn't been used yet
def notUsed(word_index, used):
    return word_index not in used

def longestPalindrome2(words):
    # memory variables
    cpt = 0
    used = []
    middle = False
    
    
    for i in range(len(words)):
        # checking if (word,index) has been used
        if not notUsed((words[i],i),used): continue
            
        # looking for a "palindrome pair" in the rest of words
        for j in range(i+1, len(words)):
            # continue is used to avoid multiple indentation
            if not isPalindromeByTwo(words[i],words[j]): continue
            if not notUsed((words[j],j),used): continue
            cpt += 4
            used.append((words[i],i))
            used.append((words[j],j))
            # breaking for j loop since a "palindrome pair" has been found
            break
            
        # words[i] hasn't been used and contains 2 same letters
        # words[i] is unique in words
        if sameLetters(words[i]) and notUsed((words[i],i),used):
            middle = True
    
    # if a middle word for the palindrome has been found
    if middle: cpt += 2
                    
    return cpt